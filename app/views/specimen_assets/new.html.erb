<div class="w-full max-w-xl mx-auto">
  <h1 class="font-serif text-4xl text-stone-900 mb-2 text-center">Upload Specimen</h1>
  <p class="text-stone-600 text-center mb-8">Contribute to our open-source specimen collection.</p>

  <% if @specimen_asset.errors.any? %>
    <div class="mb-6 p-4 bg-red-50 border border-red-200 rounded-xl">
      <h3 class="text-red-800 font-semibold mb-2">Please fix the following errors:</h3>
      <ul class="list-disc list-inside text-sm text-red-700 space-y-1">
        <% @specimen_asset.errors.full_messages.each do |message| %>
          <li><%= message %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <%= form_with model: @specimen_asset, class: "space-y-6", data: { controller: "license" } do |f| %>
    <div>
      <%= f.label :scientific_name, class: "block text-sm font-medium text-stone-700 mb-2" %>
      <%= text_field_tag "specimen_asset[scientific_name]",
        params.dig(:specimen_asset, :scientific_name),
        required: true,
        placeholder: "e.g., Papilio machaon",
        class: "w-full px-4 py-3 bg-white border border-stone-300 rounded-xl text-stone-800 placeholder:text-stone-400 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent" %>
      <p class="mt-1 text-xs text-stone-500">If this species already exists, your image will be added to it.</p>
    </div>

    <div>
      <%= f.label :common_name, class: "block text-sm font-medium text-stone-700 mb-2" %>
      <%= f.text_field :common_name,
        placeholder: "e.g., Old World Swallowtail (optional)",
        class: "w-full px-4 py-3 bg-white border border-stone-300 rounded-xl text-stone-800 placeholder:text-stone-400 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent" %>
    </div>

    <div class="grid grid-cols-2 gap-4">
      <div>
        <label class="block text-sm font-medium text-stone-700 mb-2">Taxon Source <span class="text-stone-400">(optional)</span></label>
        <%= text_field_tag "specimen_asset[taxon_source]",
          params.dig(:specimen_asset, :taxon_source),
          placeholder: "e.g., iNaturalist",
          class: "w-full px-4 py-3 bg-white border border-stone-300 rounded-xl text-stone-800 placeholder:text-stone-400 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent" %>
      </div>
      <div>
        <label class="block text-sm font-medium text-stone-700 mb-2">Taxon ID <span class="text-stone-400">(optional)</span></label>
        <%= text_field_tag "specimen_asset[taxon_id]",
          params.dig(:specimen_asset, :taxon_id),
          placeholder: "e.g., 52775",
          class: "w-full px-4 py-3 bg-white border border-stone-300 rounded-xl text-stone-800 placeholder:text-stone-400 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent" %>
      </div>
    </div>

    <div>
      <%= f.label :license, class: "block text-sm font-medium text-stone-700 mb-2" %>
      <%= f.select :license,
        [["CC0 (Public Domain)", "CC0"], ["CC-BY (Attribution Required)", "CC_BY"]],
        {},
        class: "w-full px-4 py-3 bg-white border border-stone-300 rounded-xl text-stone-800 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent",
        data: { action: "change->license#toggle", license_target: "select" } %>
    </div>

    <div data-license-target="attribution" class="hidden space-y-4 p-4 bg-amber-50 border border-amber-200 rounded-xl">
      <p class="text-sm text-amber-800 mb-4">CC-BY requires attribution information:</p>

      <div>
        <%= f.label :attribution_name, "Your Name / Organization", class: "block text-sm font-medium text-stone-700 mb-2" %>
        <%= f.text_field :attribution_name,
          placeholder: "e.g., Jane Doe",
          class: "w-full px-4 py-3 bg-white border border-stone-300 rounded-xl text-stone-800 placeholder:text-stone-400 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent" %>
      </div>

      <div>
        <%= f.label :attribution_url, "Attribution URL", class: "block text-sm font-medium text-stone-700 mb-2" %>
        <%= f.url_field :attribution_url,
          placeholder: "https://...",
          class: "w-full px-4 py-3 bg-white border border-stone-300 rounded-xl text-stone-800 placeholder:text-stone-400 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent" %>
      </div>
    </div>

    <div>
      <%= f.label :image, class: "block text-sm font-medium text-stone-700 mb-2" %>
      <div class="relative">
        <%= f.file_field :image,
          accept: "image/png,image/webp",
          required: true,
          class: "block w-full text-sm text-stone-600 file:mr-4 file:py-3 file:px-6 file:rounded-full file:border-0 file:text-sm file:font-medium file:bg-amber-100 file:text-amber-800 hover:file:bg-amber-200 file:cursor-pointer cursor-pointer" %>
      </div>
      <p class="mt-2 text-xs text-stone-500">PNG or WebP with transparent background. Minimum 512Ã—512 pixels.</p>
    </div>

    <div class="pt-4">
      <%= f.submit "Submit Specimen",
        class: "w-full px-6 py-4 bg-amber-600 text-white font-medium rounded-full hover:bg-amber-700 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:ring-offset-2 transition-colors cursor-pointer" %>
    </div>

    <p class="text-xs text-stone-500 text-center">
      Submissions are reviewed before appearing in the gallery.
    </p>
  <% end %>
</div>
